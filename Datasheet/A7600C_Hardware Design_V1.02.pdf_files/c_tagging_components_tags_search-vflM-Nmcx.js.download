define(["exports","react","./e_file_viewer_edison_shmodel_file_async","./c_core_i18n","./c_tslib"],(function(e,t,a,n,i){"use strict";function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var l=r(t);const s=({howManyMore:e,onClick:t,className:n})=>l.default.createElement(a.Text,{size:"small",className:a.cx("itc-show-more-button",{clickable:void 0!==t},n),onClick:t},"+",e),o=function(e){const{showMoreWidth:i=60,containerMaxRows:r=2,itemsToMoreTooltipString:o,expandable:c=!0,renderItem:g,items:u,className:p,showMoreClassName:_,MoreButton:d=s}=e,[m,h]=l.default.useState(u.length),[f,T]=l.default.useState(!1),y=l.default.useMemo((()=>Array(u.length).fill(0).map((e=>t.createRef()))),[u]),[v,E]=t.useState(),z=[];if(u.map(((e,t)=>{(t<=m||f)&&z.push(g({item:e,ref:y[t],index:t}))})),y.length>m&&!f){const e=o(u.slice(m+1));z.push(l.default.createElement(a.Tooltip,{id:"more-button-tooltip",title:e,key:u.length},l.default.createElement(d,{howManyMore:y.length-(m+1),onClick:c?()=>T(!0):void 0,className:_})))}const[x,C]=function(){const e=t.useRef(null),n=t.useRef(),[i,r]=t.useState(),l=t.useCallback((()=>{n.current=new a.index((e=>r(e[0]))),(null==e?void 0:e.current)&&n.current.observe(e.current)}),[e.current]);return t.useLayoutEffect((()=>(l(),()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.disconnect()})),[l]),[e,i]}();return l.default.useEffect((()=>{v&&(h(u.length),E(null))}),[null==C?void 0:C.contentRect.width]),l.default.useLayoutEffect((()=>{var e,t;if(!y||!y[0]||!v||0===v.clientWidth)return void(m!==u.length&&h(u.length));const a=((null===(t=null===(e=y[0])||void 0===e?void 0:e.current)||void 0===t?void 0:t.offsetHeight)||1)-1,n=(r-1)*a,l=y.findIndex((e=>{const t=e.current;if(t){const e=v.offsetLeft+v.clientWidth-(t.offsetLeft+t.clientWidth),l=t.offsetTop-v.offsetTop;if(e<i&&l>=n||l>=r*a)return!0}return!1}));h(l<0?u.length:l-1)}),[u.length,v]),l.default.createElement("div",{ref:x,className:a.cx("itc-container",p)},l.default.createElement("div",{key:u.length,className:"itc-items-container",ref:e=>E(e)},z),f&&l.default.createElement(a.Text,{size:"small",key:"show_less",id:"show-less",onClick:()=>T(!1),className:a.cx("itc-show-more-button clickable",_)},n.intl.formatMessage({id:"QSkw6O",defaultMessage:"show less"})))},c=a.requireCssWithComponent(o,["/static/metaserver/static/css/teams/admin/components/item_truncation_container-vflnj951-.css"]);a.injectInternalStyle("/static/metaserver/static/js/tagging/components/manual_tagging.module.out-vfl_iaZKX.css",(e=>"._tg-search_1pnzi_1 input._tg-input_1pnzi_1._tg-input-small-font-override_1pnzi_1{font-size:var(--type__body__small--fontsize)}._tg-search_1pnzi_1 ._tg-input-hashtag-accessory_1pnzi_5{line-height:var(--type__body__large--lineheight)}._tg-title_1pnzi_9{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:var(--spacing__unit--0_5)}._tg-empty-state_1pnzi_16{display:flex;flex-direction:column;padding:var(--spacing__unit--3) var(--spacing__unit--2) var(--spacing__unit--3) var(--spacing__unit--2);text-align:start}._right-rail-tags-container_1pnzi_24{margin-top:var(--spacing__unit--1_5)}._right-rail-tags-container_1pnzi_24 ._right-rail-tag-chip_1pnzi_28{margin:var(--spacing__unit--0_5) var(--spacing__unit--0_5) 0 0}._tag-section-tooltip_1pnzi_32{color:var(--color__faint__text);display:block}._tags-container_1pnzi_37 ._tag-chip_1pnzi_37{max-width:100%}._tags-container_1pnzi_37 ._tag-chip_1pnzi_37._highlighted_1pnzi_41{background-color:var(--color__attention__background--faint)}._tags-container_1pnzi_37:hover ._tag-chip_1pnzi_37._highlighted_1pnzi_41:hover{background-color:var(--color__attention__background)}._tags-container_1pnzi_37 ._tag-chip-spaced_1pnzi_49{margin-right:var(--spacing__unit--1);margin-top:var(--spacing__unit--1)}"));const g={tgSearch:"_tg-search_1pnzi_1",tgInput:"_tg-input_1pnzi_1",tgInputSmallFontOverride:"_tg-input-small-font-override_1pnzi_1",tgInputHashtagAccessory:"_tg-input-hashtag-accessory_1pnzi_5",tgTitle:"_tg-title_1pnzi_9",tgEmptyState:"_tg-empty-state_1pnzi_16",rightRailTagsContainer:"_right-rail-tags-container_1pnzi_24",rightRailTagChip:"_right-rail-tag-chip_1pnzi_28",tagSectionTooltip:"_tag-section-tooltip_1pnzi_32",tagsContainer:"_tags-container_1pnzi_37",tagChip:"_tag-chip_1pnzi_37",highlighted:"_highlighted_1pnzi_41",tagChipSpaced:"_tag-chip-spaced_1pnzi_49"};function u(e){return e.map((e=>a.formatTag(e.tag_text))).join(" ")}const p=e=>{const{tags:t,highlightedIndexes:i=[],onTagClick:r,onTagDelete:s,containerClassName:o,chipClassName:p,chipSize:_,useDigChip:d,digChipSize:m}=e;if(0===t.length)return null;const h=t.filter(((e,t)=>!i.includes(t))),f=t.filter(((e,t)=>i.includes(t))),T={auto:!0,placement:"top"};return l.default.createElement(c,Object.assign({items:[...f,...h],itemsToMoreTooltipString:u,renderItem:({item:e,ref:t,index:i})=>{const o=i<f.length,c=s?a.InputChip:a.FilterChip,u=a.isSuggestedTag(e),h=u?{withIconLeft:l.default.createElement(a.UIIcon,{src:a.Twinkle2Line,size:"small"})}:{},y=d?l.default.createElement(a.Chip,{key:e.tag_text,ref:t,className:p,onClick:t=>null==r?void 0:r(e,t),size:m},l.default.createElement(a.Chip.Content,null,a.formatTypedTag(e))):l.default.createElement(c,Object.assign({},h,{key:e.tag_text,ref:t,className:a.cx(g.tagChip,{highlighted:o},"tag-chip-spaced"===p?g.tagChipSpaced:"right-rail-tag-chip"===p?g.rightRailTagChip:p),onClick:t=>null==r?void 0:r(e,t),onDelete:s?()=>null==s?void 0:s(e):void 0,size:_||"small"}),l.default.createElement(a.Truncate,{tooltipControlProps:T},a.formatTypedTag(e)));return u?l.default.createElement(a.Tooltip,{title:n.intl.formatMessage({id:"NXiDuW",defaultMessage:"Dropbox added this tag"})},y):y},className:a.cx(g.tagsContainer,"right-rail-tags-container"===o?g.rightRailTagsContainer:o)},e))};p.displayName="TagsContainer";const _=({placeholderText:e})=>l.createElement("div",{className:g.tgEmptyState},l.createElement(a.Text,{variant:"label",size:"small",color:"faint",tagName:"p"},e));_.displayName="EmptyState";const d=e=>{var{disabled:t,children:n}=e,r=i.__rest(e,["disabled","children"]);return t?l.createElement(l.Fragment,null,n):l.createElement(a.Tooltip,Object.assign({},r),n)};d.displayName="Tooltip";const m=({hasFocus:e})=>l.createElement(a.Text,{size:"small",color:e?"standard":"faint",className:g.tgInputHashtagAccessory},"#");m.displayName="LeftAccessory";const h=({user:e,maxTagsReached:t,readOnly:n=!1,excludeResults:i,onSelection:r,onInputFocus:s,onStartTyping:o,onInputBlur:c,getStrings:u,allTagsSuggestions:p,fetchAllTagsSuggestions:h})=>{const[f,T]=l.useState(""),[y,v]=l.useState([]),[E,z]=l.useState(!1),{addTypeaheadEmptyState:x,createTagPrefix:C,addTag:b,invalidCharsError:S,maxTagsReachedError:w,tooLongError:k,alreadyExistsError:N,readOnlyError:I}=u();l.useEffect((()=>{h({user:e})}),[]),l.useEffect((()=>{const e=f.toLowerCase();if(O(e)||void 0===p)return void v([]);const t=a.trimHashtags(e),n=a.getTagsSuggestions(t,p).filter(a.isUserGeneratedTag).map((e=>e.tag_text)).filter((e=>!i.includes(e)));v(n)}),[f,p,i]);const R=e=>l.createElement(a.Typeahead.Row,{key:`@${e}`,id:`@${e}`,value:e,withTitle:l.createElement(a.Text,{size:"small"},a.formatTag(e))}),M=e=>l.createElement(a.Typeahead.Row,{key:e,value:e,withTitle:C?l.createElement(a.Text,{size:"small"},C+" ",l.createElement(a.Text,{size:"small",isBold:!0},a.formatTag(e))):l.createElement(a.Text,{size:"small"},a.formatTag(e)),id:e}),O=e=>!(/^#*[\p{L}0-9_]+$/iu.test(e)&&e.length<=32||/^\#*$/i.test(e)),j=({currentTarget:{value:e}})=>{0===f.length&&1===e.length&&(null==o||o()),T(e)},L=t?w:n?I:void 0,F=f.toLowerCase(),P=a.trimHashtags(F),W=""!==P&&0===y.length&&i.includes(P),H=O(F)||W,A=H||i.includes(P)||y.includes(P)||""===P?[]:[F],D=n||t;return l.createElement(a.Typeahead.Wrapper,{onSelection:e=>{T(""),r(e)},onFocus:()=>{null==s||s(),z(!0)},onBlur:()=>{null==c||c(f),z(!1)},className:g.tgSearch},(({getTriggerProps:e,getContentProps:t,closeMenu:n})=>l.createElement(l.Fragment,null,l.createElement(d,{disabled:!D,id:"more-button-tooltip",title:L},l.createElement(a.TextInput,Object.assign({id:"trigger"},e({onChange:j}),{value:f,"aria-label":b,placeholder:b,disabled:D,withLeftAccessory:l.createElement(m,{hasFocus:E||f.length>0}),autoComplete:"off",isInvalid:H,className:a.cx(g.tgInput,g.tgInputSmallFontOverride),onKeyPress:e=>((e,t)=>{if(e.key===a.Key_enum.Key.Enter&&""!==f){if(O(f)||i.includes(P))return;const e=a.trimHashtags(f).toLowerCase();r(e),T(""),t({})}})(e,n)}))),H&&l.createElement(a.FormHelperText,{variant:"alert",id:"bad-parms-input-helper"},l.createElement(a.UIIcon,{src:a.FailLine,size:"small"}),f.length>=32?k:W?N:S),l.createElement(a.Typeahead.Container,Object.assign({},t(),{auto:!1,isEmptyQuery:0===f.length,placement:"bottom-start",emptyPrompt:l.createElement(_,{placeholderText:x})}),l.createElement(a.Typeahead.Results,{results:y.slice(0,3),renderRow:R}),l.createElement(a.Typeahead.Results,{results:A,renderRow:M})))))};h.displayName="TagsSearch",e.ItemTruncationContainerWithoutCss=o,e.TagsContainer=p,e.TagsSearch=h,e.classes=g}));
//# sourceMappingURL=c_tagging_components_tags_search.js-vflSUGGrn.map
