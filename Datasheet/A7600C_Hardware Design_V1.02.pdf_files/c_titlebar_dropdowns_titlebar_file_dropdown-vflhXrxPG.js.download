define(["require","exports","react","./e_file_viewer_edison_shmodel_file_async","./c_ui-icon_line_copy","./c_ui-icon_line_delete","./c_tslib","./c_ui-icon_line_file-history","./c_core_i18n","./c_flows_conversions_conversion_actions","./c_workflow_builder_workflow_actions_action_ui_config","./c_ui-icon_line_rewind","./c_ui-icon_line_move","./c_action_plugins_open_in_action_dropdown","./c_ui-icon_line_cursor","./c_sdk_file_viewer_common_hooks","./c_conversions_actions_unzip","./c_cloud_docs_open_with_utils","./c_file_viewer_components_titlebar_menu_content","./e_edison","./c_apex-metrics_src_types","./e_core_exception","./c_core_exception_info","./c_lodash-es_lodash","./c_core_notify","react-dom","metaserver/static/js/modules/constants/env","./c_src_sink_index","metaserver/static/js/modules/constants/viewer","./c_core_xhr","./c_csrf","./c_init_data_runtime","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/fingerprintjs_constants","metaserver/static/js/modules/constants/sharing","./c_security_util","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/pdf_editing","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/unity","metaserver/static/js/modules/constants/files_spa","metaserver/static/js/langpack","./c_flows_conversions_convert","./c_ui_image","./c_flows_utils_browse_logger","./c_capture_redux_store","./c_sync_everything_redux_selectors","./c_browse_tts","./c_flows_redux_reducer","./c_flows_redux_store","./c_flows_redux_actions","./c_flows_redux_selectors","./c_flows_utils_async_modal_launchers","./c_ui-icon_line_automation","./c_ui-icon_line_file","./c_ui-icon_line_video-file","./c_ui-icon_line_video","./c_ui-icon_line_audio","./c_ui-icon_line_folder","./c_file_imports_gdrive_file_picker","./c_icon_shortcuts_icon","./c_ui_title_bubble","./c_ui_overlay","./c_raf_throttle","./c_tagging_components_tags_search","./c_data_action_creators_index","./c_tagging_api","./c_tagging_logger","./c_shared_with_redux_store","./c_sharing_avatar_info","./c_structured_tags_redux_action_creators","./c_folder_dialog_folder_picker_dig","./c_table_columns_file_name_column","./c_src_table","./c_ui-icon_line_arrow-down","./c_pap-events_sign_save_signature_doc","./c_combinations_index","./c_spectrum_icon_arrow_index","./c_browse_interface","./c_folder_dialog_constants","./c_ui-icon_line_help","./c_folder_dialog_api","./c_ui-icon_line_add-circle","./c_plugin_utils_getImageDefaultSizes","./c_spectrum_tooltip","./c_extensions_extensions_utils","./c_spectrum_modal_utility_modal","./c_spectrum_button","./c_icon_templates_actionable_index","./c_spectrum_icon_form_index","./c_account_email","./c_account_email_verify_reasons","./c_form","./c_ui_input_dig","./c_styled-components","./c_ui-icon_fill_fail","./c_ui-icon_line_folder-show","./c_ui-icon_fill_star"],(function(e,i,t,o,n,r,c,s,a,l,_,u,d,S,f,v,w,p,A,E,I,P,g,m,h,D,C,T,O,N,b,K,R,L,y,F,x,M,V,U,H,k,G,j,B,W,z,Y,q,Z,Q,X,$,J,ee,ie,te,oe,ne,re,ce,se,ae,le,_e,ue,de,Se,fe,ve,we,pe,Ae,Ee,Ie,Pe,ge,me,he,De,Ce,Te,Oe,Ne,be,Ke,Re,Le,ye,Fe,xe,Me,Ve,Ue,He,ke,Ge,je,Be,We,ze,Ye,qe,Ze,Qe){"use strict";function Xe(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var $e=Xe(t);const Je=Object.assign(Object.assign({},o.fileActionCondition),{filterValidFile:e=>{const i=o.fileActionCondition.filterValidFile(e);return!i||o.isInsideVaultFolder(i)||o.isPnmSuppressMoveSelected(i)||o.isEncryptedFile(i)?void 0:i}}),ei=o.withActionCondition(Je,((i,t,r,c)=>({label:o.COPY_ACTION_STRING,userAction:o.UserAction.Copy,icon:n.CopyLine,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_copy_action_action"],i,t)})).then((({copyActionWrapper:e})=>e({file:i.file,user:i.user,context:t,browseContext:r,browseExceptions:c})))},disabled:{disabled:!1}})),void 0),ii=o.fileActionCondition,ti=o.withActionCondition(ii,((i,t,n,c)=>({label:o.DELETE_ACTION_STRING,icon:r.DeleteLine,userAction:o.UserAction.Delete,disabled:i.file.read_only?{disabled:!0,tooltipMessage:o.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_delete_action_action"],i,t)})).then((({deleteActionWrapper:e})=>e({file:i.file,user:i.user,context:t,previewSurface:n,onFileChanged:c})))}})),void 0),oi=[o.SDKPreviewSurface.BROWSE,o.SDKPreviewSurface.CLIENT_PORTAL,o.SDKPreviewSurface.COLLECTIONS,o.SDKPreviewSurface.FILE_LOCKING,o.SDKPreviewSurface.HELLOSIGN,o.SDKPreviewSurface.HOME,o.SDKPreviewSurface.INBAND_SHARE,o.SDKPreviewSurface.PHOTOS,o.SDKPreviewSurface.RECENTS,o.SDKPreviewSurface.SEARCH,o.SDKPreviewSurface.SHARED_COLLECTION,o.SDKPreviewSurface.SHARED_CONTENT_LINK,o.SDKPreviewSurface.SHARED_LINK,o.SDKPreviewSurface.SHARED_LINK_EMBED,o.SDKPreviewSurface.STANDALONE_PREVIEW,o.SDKPreviewSurface.STARRED,o.SDKPreviewSurface.TRANSFER,o.SDKPreviewSurface.UNKNOWN,o.SDKPreviewSurface.VERSION_HISTORY,o.SDKPreviewSurface.VIDEO_HOME,o.SDKPreviewSurface.VIDEO_SYNTHESIS],ni={filterValidFile:o.allowAllFiles,filterValidUser:o.filterLoggedInUser,shouldShowForPreviewSurface:o.filterSurfaceIn(oi),shouldShowForPreviewType:o.alwaysShow},ri=o.withActionCondition(ni,((e,i)=>({userAction:void 0,icon:s.FileHistoryLine,label:o.FILE_ACTIVITY_ACTION_STRING,accessibleLabel:o.FILE_ACTIVITY_ACCESSIBILITY_STRING,action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){return i()}))},disabled:{disabled:!1}})),void 0);const ci=e=>{const{conversionActions:i,file:t}=e,o=i.filter((e=>e.actionGroup===l.ConversionActionGroup.VIDEO_SCALE)),n=i.filter((e=>e.actionGroup!==l.ConversionActionGroup.VIDEO_SCALE)),r=n.length>0?si(n,t,e):null,c=o.length>0?si(o,t,e):null;return $e.default.createElement($e.default.Fragment,null,r,c)},si=(e,i,t)=>$e.default.createElement(o.Menu.Segment,null,e.map((e=>{const n=i.bytes/Math.pow(1024,2),r=_.getConversionFileSizeLimitMB([o.file_extension(o.getFilename(i))],e.actionText),c=n>r,s=a.intl.formatMessage({id:"0vePbC",defaultMessage:"File is larger than the {fileSizeLimitMB}MB limit"},{fileSizeLimitMB:r}),l=$e.default.createElement(o.Menu.ActionItem,{key:e.actionText,disabled:c,value:{handler:()=>(({file:e,user:i,action:t,encryptionOptions:n,logUserAction:r,context:c,shareToken:s})=>{if(r(o.UserAction.SelectSaveAs,c,{conversion_type:t.actionText}),i)t.convert([e],i,{shareToken:s,source:"preview"});else{const i=new URL(window.location.href);i.searchParams.set("save_as","true"),i.searchParams.set("save_as_action",t.actionText),window.history.replaceState(i.href,"",i.href),o.showAuthModal({mode:o.AuthMode.REGISTER,sharedLinkUrl:i.href,kind:o.LoginOrRegisterKind$1.POSTSAVEAS,encryptionOptions:n,loggingExtra:{signup_source:"save_as"},signupTag:o.RegistrationSource.SHMODEL_SAVE_AS_REGISTER,webSignInTag:o.getWebSignInTag(!1,e.is_dir),authDialogPreviousElement:o.AuthDialogPreviousElementTag.SAVE_AS})}})(Object.assign(Object.assign({},t),{action:e}))},withLeftAccessory:$e.default.createElement(o.UIIcon,{src:e.actionIcon,width:"20px",height:"20px"})},e.actionText);return c?$e.default.createElement(o.Tooltip,{key:e.actionText,title:s,placement:"left",id:"flows-disabled-menu-item-tooltip"},$e.default.createElement("div",null,l)):l}))),ai=[o.SDKPreviewSurface.BROWSE,o.SDKPreviewSurface.COLLECTIONS,o.SDKPreviewSurface.FILE_LOCKING,o.SDKPreviewSurface.HELLOSIGN,o.SDKPreviewSurface.HOME,o.SDKPreviewSurface.INBAND_SHARE,o.SDKPreviewSurface.PHOTOS,o.SDKPreviewSurface.RECENTS,o.SDKPreviewSurface.SEARCH,o.SDKPreviewSurface.SHARED_CONTENT_LINK,o.SDKPreviewSurface.SHARED_LINK,o.SDKPreviewSurface.STANDALONE_PREVIEW,o.SDKPreviewSurface.STARRED,o.SDKPreviewSurface.VIDEO_HOME],li={filterValidFile:e=>!e||o.isInsideSharedFolder(e)||o.isEncryptedFile(e)?void 0:e,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:o.filterSurfaceIn(ai),shouldShowForPreviewType:o.alwaysShow},_i=o.withActionCondition(li,((e,i,t,n,r)=>{const c=function({getActiveFile:e,user:i},t){const{file:n,sharedLinkInfo:r,sharePermission:c}=e();return o.canConvertFile(n,c)&&o.canDownloadFile(r,c)?l.getConversionActionsForFiles([n],{},t):[]}({getActiveFile:t,user:e.user},n);if(c.length)return{label:o.FILE_CONVERSION_STRING,userAction:o.UserAction.OpenSaveAs,disabled:{disabled:!1},icon:u.ConvertFileLine,action:{type:"menu",menu:$e.default.createElement(ci,{context:o.UserActionContext.FileMenu,conversionActions:c,encryptionOptions:r,file:e.file,logUserAction:i.logUserAction,user:e.user})}}}),void 0),ui=e=>({userAction:void 0,disabled:{disabled:!1},action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){return e()}))},label:o.INFO_ACTION_STRING,accessibleLabel:o.INFO_ACCESSIBILITY_STRING,icon:o.InfoLine}),di=Object.assign(Object.assign({},o.fileActionCondition),{filterValidFile:e=>{const i=o.fileActionCondition.filterValidFile(e);return!i||o.isInsideVaultFolder(i)||o.isPnmSuppressMoveSelected(i)?void 0:i}}),Si=o.withActionCondition(di,((i,t,n,r,c,s)=>({label:o.MOVE_ACTION_STRING,icon:d.MoveLine,userAction:o.UserAction.Move,disabled:i.file.read_only?{disabled:!0,tooltipMessage:o.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_move_action_action"],i,t)})).then((({moveActionWrapper:e})=>e({file:i.file,user:i.user,context:t,previewSurface:n,onFileChanged:r,browseContext:c,browseExceptions:s})))}})),void 0),fi=[o.PreviewType.SsrDoc,o.PreviewType.CloudDoc,o.PreviewType.Image,o.PreviewType.HTML,o.PreviewType.Excel],vi={shouldShowForPreviewSurface:o.alwaysShow,shouldShowForPreviewType:o.filterPreviewTypeIn(fi),filterValidUser:e=>({user:e}),filterValidFile:(e,i,t)=>t||o.isEncryptedFile(e)?void 0:e},wi=o.withActionCondition(vi,((e,i)=>({label:o.PRINT_ACTION_STRING,userAction:o.UserAction.Print,disabled:{disabled:!1},action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){return i()}))},icon:u.PrintLine})),void 0),pi=o.withActionCondition(o.renameActionConditions,((e,i)=>({label:o.RENAME_ACTION_STRING,icon:f.CursorLine,userAction:o.UserAction.Rename,action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){i.logUserAction(o.UserAction.RenameStart,o.UserActionContext.FileMenu),i.navigation.toggleRenameState(!0)}))},disabled:{disabled:!1}})),void 0),Ai=[o.SDKPreviewSurface.BROWSE,o.SDKPreviewSurface.COLLECTIONS,o.SDKPreviewSurface.FILE_LOCKING,o.SDKPreviewSurface.HELLOSIGN,o.SDKPreviewSurface.HOME,o.SDKPreviewSurface.INBAND_SHARE,o.SDKPreviewSurface.PHOTOS,o.SDKPreviewSurface.RECENTS,o.SDKPreviewSurface.SEARCH,o.SDKPreviewSurface.SHARED_CONTENT_LINK,o.SDKPreviewSurface.SHARED_LINK,o.SDKPreviewSurface.STANDALONE_PREVIEW,o.SDKPreviewSurface.STARRED,o.SDKPreviewSurface.VIDEO_HOME],Ei={filterValidFile:e=>o.isStarringEnabled(e)?e:void 0,filterValidUser:o.filterLoggedInUser,shouldShowForPreviewSurface:o.filterSurfaceIn(Ai),shouldShowForPreviewType:o.alwaysShow},Ii=o.withActionCondition(Ei,((e,i,t,n,r)=>({label:n,icon:t,userAction:i?o.UserAction.Unstar:o.UserAction.Star,action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){return r()}))},disabled:{disabled:!1}})),void 0),Pi=o.defineMessage({id:"pB6h1Y",defaultMessage:"Archive files over 512 MB cannot be extracted"}),gi=o.withActionCondition(o.unzipActionConditions,((i,t)=>{const n=i.file.bytes/1048576;return{label:w.UNZIP_ACTION_MESSAGE,icon:w.UnzipAction.actionIcon,disabled:n>=o.UNZIP_MAX_FILESIZE_MB?{disabled:!0,tooltipMessage:Pi}:{disabled:!1},userAction:o.UserAction.Unzip,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_unzip_action_action"],i,t)})).then((({unzipAction:e})=>e({user:i.user,file:i.file,shareToken:t})))}}}),void 0),mi=[o.SDKPreviewSurface.BROWSE,o.SDKPreviewSurface.BACKUP,o.SDKPreviewSurface.COLLECTIONS,o.SDKPreviewSurface.FILE_LOCKING,o.SDKPreviewSurface.HELLOSIGN,o.SDKPreviewSurface.HOME,o.SDKPreviewSurface.INBAND_SHARE,o.SDKPreviewSurface.PHOTOS,o.SDKPreviewSurface.RECENTS,o.SDKPreviewSurface.SEARCH,o.SDKPreviewSurface.SHARED_CONTENT_LINK,o.SDKPreviewSurface.SHARED_LINK,o.SDKPreviewSurface.STANDALONE_PREVIEW,o.SDKPreviewSurface.STARRED,o.SDKPreviewSurface.VIDEO_HOME,o.SDKPreviewSurface.VIDEO_SYNTHESIS],hi={filterValidFile:e=>function(e){const i=o.fileActionCondition.filterValidFile(e);return!!i&&!p.isCloudBasedDoc(i)&&!o.isPointerByExtension(i.fq_path)}(e)?e:void 0,filterValidUser:o.filterLoggedInUser,shouldShowForPreviewSurface:o.filterSurfaceIn(mi),shouldShowForPreviewType:o.alwaysShow};const Di=o.withActionCondition(hi,(i=>({label:o.VERSION_HISTORY_ACTION_STRING,icon:o.ClockLine,userAction:o.UserAction.VersionHistory,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_version_history_action_action"],i,t)})).then((({versionHistoryActionWrapper:e})=>e(i.file,i.user)))}})),void 0),Ci={filterValidFile:(e,i,t,o)=>o?e:void 0,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:e=>e===o.SDKPreviewSurface.VERSION_HISTORY,shouldShowForPreviewType:o.alwaysShow},Ti=o.withActionCondition(Ci,((e,i)=>{if(i)return{label:o.RESTORE_ACTION_STRING,icon:u.RewindLine,userAction:o.UserAction.Restore,disabled:{disabled:!1},action:{type:"click",handler:()=>c.__awaiter(void 0,void 0,void 0,(function*(){return i()}))}}}),void 0);i.default=({contentProps:e})=>{var i,t;const{previewSurface:n,pluginArgs:r,fileConfig:c,hasOpenInActions:s}=o.usePluginMigrationContext(),{fileViewerId:a,pluginContext:l,logUserAction:_}=o.useFileViewerContext(),u=o.useFileViewerSelector(o.getCurrentPreviewKey,a),d=null!==(i=o.useCurrentPreviewMetadata().previewType)&&void 0!==i?i:o.PreviewType.Loading,f=r.getActiveFile().file,w=r.getActiveFile().sharePermission,p=r.user,E=o.useRootFile(),{data:I}=o.useFileContentMetadataQueryFromPlugins(E),P=null===(t=null==I?void 0:I.apiData)||void 0===t?void 0:t.metadata,{onFileChanged:g,browseContext:m,browseExceptions:h,canRestoreRevision:D,getActiveFile:C,shareToken:T,encryptionOptions:O,authModalKind:N,onRestoreRevision:b}=r,K=$e.useMemo((()=>({file:f,user:p,previewSurface:n,previewType:d,sharePermission:w,previewKey:u,canRestoreRevision:D})),[f,D,u,n,d,w,p]),R=((e,i)=>{const t=o.getStoreForStarred(),{isStarred:n,message:r,iconSrc:c,handleClick:s}=v.useStarControlWithStore({getActiveFile:i,user:e.user,starredStore:t});return $e.default.useMemo((()=>Ii(e,n,c,r,s)),[e,s,c,n,r])})(K,C),L=((e,i,t)=>{const n=o.useDispatch(),{onPrint:r}=o.usePreviewControls(),c=o.useRootPreviewKey(i),s=o.useCurrentPreviewMetadata(),a=o.useStabilizedCallback((()=>{null==r||r(),n(o.print({fileViewerId:i,previewKey:c,previewType:s.previewType,sourceContext:o.UserActionContext.FileMenu,skipLogging:!0}))})),l=!o.getCloudDocExitUrl(s)&&t.enable_print;return $e.default.useMemo((()=>l?wi(e,a):void 0),[e,a,l])})(K,a,c),y=(e=>{const i=o.useSetLeftSidebarCallback(o.FILE_ACTIVITY_PLUGIN_ID,o.UserActionContext.FileMenu);return $e.default.useMemo((()=>ri(e,i)),[e,i])})(K),F=(()=>{const e=o.useSetLeftSidebarCallback(o.INFO_BLADE_PLUGIN_ID,o.UserActionContext.FileMenu);return $e.default.useMemo((()=>ui(e)),[e])})(),x=$e.useMemo((()=>[[Si(K,l,n,g,m,h),ei(K,l,m,h),ti(K,l,n,g),pi(K,l)],[R],[F,Di(K),y],[S.makeOpenInAction(K,!!s),_i(K,l,C,P,O),gi(K,T),...o.makeDownloadActions(K,C,l,P,n,T,w,O,N),Ti(K,b)],[L]]),[N,m,h,K,l,O,y,P,C,s,F,g,b,n,L,w,T,R]),M=$e.useCallback((e=>_(e,o.UserActionContext.FileMenu)),[_]);return $e.createElement(A.TitlebarMenuContent,{options:x,elementId:"file-menu",contentProps:e,logAction:M})}}));
//# sourceMappingURL=c_titlebar_dropdowns_titlebar_file_dropdown.js-vflsqu8Hp.map
