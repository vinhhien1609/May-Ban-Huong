define(["require","exports","./e_file_viewer_edison_shmodel_file_async","./e_core_exception","./c_core_i18n","metaserver/static/js/modules/constants/web_experience_constants","./c_core_exception_info","./e_edison","./c_sync_everything_redux_selectors","./c_tslib"],(function(e,t,r,s,n,i,a,o,c,l){"use strict";function u(e,t,r){const s="=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let n=0;n<Math.max(e.length,t.length);n++){const i=e.charAt(n),a=t.charAt(n);if(!i)return-r;if(!a)return r;const o=s.indexOf(i),c=s.indexOf(a);if(o<c)return-r;if(c<o)return r}return 0}function d(e,t,r,s){if(Array.isArray(e)&&Array.isArray(t)){for(let s=0;s<Math.max(e.length,t.length);s++){const n=e[s],i=t[s];if(null==n)return-r;if(null==i)return r;if("number"==typeof n&&"string"==typeof i)return-r;if("number"==typeof i&&"string"==typeof n)return r;if("string"==typeof n&&"string"==typeof i){const e=u(n,i,r);if(0!==e)return e}else{if(n<i)return-r;if(i<n)return r}}return 0}return e===t?0:s&&"string"==typeof e&&"string"==typeof t?s(e,t)<0?-r:r:e<t?-r:r}function S(e,{sortField:t,sortDirection:i},o){const c=function(e,t){switch(e){case r.SortField.FILENAME:case r.SortField.SHARED_WITH:return e=>T(e,r.File.getFilename(e));case r.SortField.MODIFIED:return e=>T(e,e.ts);case r.SortField.CATEGORY:return e=>T(e,r.File.getCategoryDescription(e));case r.SortField.EXTENSION:return e=>T(e,r.File.getExtension(e));case r.SortField.SIZE:return e=>T(e,e.is_dir&&(null==t?void 0:t.has(e.fq_path))?t.get(e.fq_path).size:e.bytes);case r.SortField.PARENT_FOLDER:return e=>T(e,r.File.getParentDirName(e));case r.SortField.RECENT_ACTIVITY:return e=>{var t;return T(e,null===(t=e.recentsInfo)||void 0===t?void 0:t.activity_timestamp_ms)};default:return}}(t,o),l=function(e,t){const s=n.case_insensitive_comparator(!0),i=t===r.SortDirection.ASCENDING?1:-1;switch(e){case r.SortField.FILENAME:case r.SortField.SHARED_WITH:case r.SortField.SIZE:case r.SortField.PARENT_FOLDER:case r.SortField.RECENT_ACTIVITY:return function(e,t){return function({isFolder:r,value:s,isAlwaysFirst:n},{isFolder:i,value:a,isAlwaysFirst:o}){const c=_(n,o);return 0!==c?c:(s||(s=1/0*e),a||(a=1/0*e),r&&i?d(s,a,e,t):r?-e:i?e:d(s,a,e,t))}}(i,s);case r.SortField.MODIFIED:case r.SortField.CATEGORY:case r.SortField.EXTENSION:return function(e,t){return function({isFolder:r,value:s,isAlwaysFirst:n},{isFolder:i,value:a,isAlwaysFirst:o}){const c=_(n,o);return 0!==c?c:r&&i?d(s,a,e,t):r?1:i?-1:""===s?1:""===a?-1:d(s,a,e,t)}}(i,s);default:return}}(t,i);return c&&l?e.sortBy(c,l):(s.reportException({err:new Error("sortFiles was called with an unsupported sort field"),tags:["browse_sort_invalid_field"],severity:a.SEVERITY.CRITICAL,exc_extra:{sort_field:t}}),e)}function T(e,t){return{isFolder:e.is_dir,value:t,isAlwaysFirst:E(e)}}function E(e){return r.File.isTeamMemberFolder(e)||r.File.isFamilySharedFolder(e)}function _(e,t){return e&&t?0:e?-1:t?1:0}const p=e=>r.getStateAtNamespace(e,r.BROWSE_NAMESPACE_KEY)||r.defaultBrowseState,O=e=>p(e).context,g=e=>p(e).experiments,f=e=>{var t;return null===(t=e[r.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.experiments},F=e=>p(e).browsePostTTIExperiments,y=e=>{var t;return null===(t=e[r.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.browsePostTTIExperiments},A=e=>p(e).folderSizes,b=e=>p(e).loadingState;r.createSelector(b,(e=>e===r.LoadingState.LOADING_FIRST_PAGE));const I=e=>p(e).path,R=e=>p(e).selection,m=e=>p(e).browsePostTTIData,h=e=>{const t=p(e).user;return o.assert(null!=t,"Browse store `user` accessed before APP_INIT action"),t},v=r.createSelector((e=>p(e).filterTypes||r.immutableExports.Set([])),(e=>e.isEmpty()?r.BrowseFilterType.NONE:e.first())),j=e=>p(e).browsePostTTIExperiments||{};r.createSelector(m,(e=>Object.assign({},e.uploaderPostTTIExperiments)));const w=e=>p(e).unsortedFiles;r.createSelector(w,(e=>e.keySeq().toArray().map((e=>({filename:r.filename(e).toLowerCase(),fqPath:e}))).sort(((e,t)=>e.filename<t.filename?-1:e.filename>t.filename?1:0))));const N=r.createSelector(w,(e=>{const t=r.selectScopedSort(e,{instanceId:r.BROWSE_FILES_VIEW_ID});return t||r.BROWSE_DEFAULT_SORT_ORDER}),A,O,g,((e,t,r,s,n)=>S(e.toList(),t,r))),L=r.createSelector(w,R,((e,t)=>P(e,t))),D=r.createSelector(L,r.previewThumbnails,((e,t)=>e.count()>0?e.withMutations((e=>{e.forEach(((s,n)=>{var i;if(!s.thumbnail_url_tmpl&&(null===(i=t[s.file_id])||void 0===i?void 0:i.preview_url)){const i=t[s.file_id].preview_url;e.set(n,new r.File(Object.assign(Object.assign({},s),{thumbnail_url_tmpl:i})))}}))})):e));r.createSelector(L,w,((e,t)=>e.size===t.size));const P=(e,t)=>t.selected.isEmpty()||e.isEmpty()?r.immutableExports.OrderedMap():r.immutableExports.OrderedMap(t.selected.map((t=>{const r=e.find((e=>e.fq_path===t));return r?[r.fq_path,r]:void 0}))),C=r.createSelector(h,(e=>{const t=p(e).viewer;return o.assert(null!=t,"Browse store `viewer` accessed before APP_INIT action"),t}),I,((e,t,s)=>r.browse_root(t,e))),M=r.createSelector(N,A,((e,t)=>e.map((e=>{const r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e}))));r.createSelector(w,A,((e,t)=>e.withMutations((r=>{t.forEach(((t,s)=>{const n=e.get(s);if(n&&t){const e=n.updateSize(t.size,t.state);r.set(s,e)}}))})))),r.createSelector(L,(e=>e&&1===e.size&&e.first().is_dir&&!r.File.isNoAccessSharedFolder(e.first()))),r.createSelector(h,O,((e,t)=>e.is_cdm_member&&e.is_team_admin&&t.isCurrentlyInRoot||!!t.isCurrentPathWriteable()));r.createSelector(O,g,m,b,((e,t,s,n)=>Boolean(!s.mobileWebInvites&&e.isCurrentlyInRoot&&e.isInsideMyTeamFolderTree&&n===r.LoadingState.LOADED))),r.createSelector(O,(e=>e.isInsideMyTeamFolderTree&&e.isCurrentlyInRoot)),r.createSelector(m,(e=>{var t;return Boolean(null===(t=e.userHasSharedFileOrFolderInfo)||void 0===t?void 0:t.has_shared_file_or_folder)})),r.createSelector(m,(e=>Boolean(e.isProTrialUser))),r.createSelector(m,(e=>e.teamTopLevelContentPolicy)),r.createSelector(L,(e=>e.count()>0?"selected":"unselected")),r.createSelector(L,(e=>0===e.count()));const U=e=>p(e).currentFolderInfo,B=r.createSelector(O,U,((e,t)=>null!=t&&t.type!==r.FileTypes.TEAM_MEMBER_FOLDER&&e.isInFolderMode&&!e.isCurrentlyInRoot)),x=r.createSelector(B,O,U,((e,t,s)=>s&&e&&!t.isInsideVaultFolder&&!t.isInsideTeamFolderRoot&&!t.isEncrypted&&!r.File.isReadOnlySharedFolder(s)));r.createSelector(L,j,((e,t)=>!!t.expEnableBackupWeb&&c.isBackupFolderIcon(e.first()))),r.createSelector(c.backupFolderPathByFile,I,((e,t)=>e({fq_path:t})));const z=r.createSelector(U,c.isInsideBackupFolderByFile,((e,t)=>!!r.isBackupBrowse()||!!e&&t(e)));r.createSelector(I,c.folderBackupInfoByPath,((e,t)=>t(e)));const V=r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.manualTagging)&&void 0!==t?t:"OFF"}));r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.flowsAutomatedFolderUi)&&void 0!==t&&t})),r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.flowsAutoTagUi)&&void 0!==t&&t})),r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.autoTaggingAwarenessVariant)&&void 0!==t?t:"OFF"}));const W=r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.manualClassification)&&void 0!==t?t:"OFF"}));r.createSelector(f,(e=>"V2"===(null==e?void 0:e.flowsRemoveRightRail))),r.createSelector(V,(function(e){return!!e&&["V1","V1_WITH_BULK","V1_WITH_BULK_FOR_OPTED_IN_TEAMS","V1_WITH_COLUMN","V2","V2_FOR_OPTED_IN_TEAMS"].includes(e)})),r.createSelector(V,(function(e){return!!e&&["V1_WITH_COLUMN","V2_FOR_OPTED_IN_TEAMS"].includes(e)}));const G=(e,t)=>{const s=t[r.getFileMapKey(e)];let n=e;return void 0!==s&&(n=new r.File(Object.assign(Object.assign({},e),{tags:s.map((e=>({value:e,highlighted:!1})))}))),n};r.createSelector(M,r.selectTagsByFile,((e,t)=>e.map((e=>G(e,t)))));const q=r.createSelector(w,r.selectTagsByFile,((e,t)=>e.withMutations((e=>{e.forEach(((r,s)=>{e.set(s,G(r,t))}))}))));r.createSelector(q,R,((e,t)=>P(e,t))),r.createSelector(U,r.selectTagsByFile,((e,t)=>{if(void 0!==e)return G(e,t)})),r.createSelector(y,(e=>"ON"===(null==e?void 0:e.expBackupNewLocationHint)));const H=r.createSelector(y,(e=>{var t;return null!==(t=null==e?void 0:e.expGgToCdmMigrationVariant)&&void 0!==t?t:"OFF"}));r.createSelector(H,(e=>["CONTROL","V1"].includes(e)));const k=r.createSelector(D,(e=>!0==!!(null==e?void 0:e.size))),Q=r.createSelector(D,k,((e,t)=>t?e.first():void 0)),Y=r.createSelector(O,Q,((e,t)=>((e,t)=>t?r.File.canViewFileMembers(t,e):e.canViewContainingNSMembers)(e,t)));r.createSelector(Y,Q,((e,t)=>((e,t)=>{var r;return!e&&t?null===(r=t._mount_access_perms)||void 0===r?void 0:r.includes("can_view"):e})(e,t))),r.createSelector(F,(e=>{var t;return null!==(t=e.expSuggestedWorkflowsM1)&&void 0!==t?t:"OFF"})),r.createSelector(f,(e=>{var t;return null!==(t=null==e?void 0:e.folderHistoryRollbacks)&&void 0!==t&&t})),r.createSelector(O,h,((e,t)=>{const s=r.GoldenGate.hasContentManagerAndSuperAdmin(t.id);return e.isCurrentlyInRoot&&!t.is_cdm_member&&s&&!e.isInsideVaultFolder&&!e.isEncrypted&&!(t.is_tmr_member&&e.currentFQPath===t.cdm_tmf_path)})),r.createSelector(q,(e=>p(e).quickViewFileId),((e,t)=>e.find((e=>e.file_id===t)))),r.createSelector(F,(e=>{var t;return null!==(t=e.browseHighlightCopyLink)&&void 0!==t?t:"OFF"}));const K="browse_right_rail_collapsed_preferences",Z="browse_right_sidebar_preferences";function X(e){var t;try{return null===(t=r.UserLocalStorage.get(e,K))||void 0===t||t}catch(e){return s.reportException({err:e,severity:"non-critical"}),!0}}var J;function $(e){return function(e){var t;try{return null!==(t=r.UserLocalStorage.get(e,Z))&&void 0!==t?t:void 0}catch(e){return void s.reportException({err:e,severity:"non-critical"})}}(e)}function ee(s=r.defaultBrowseState,n){switch(n.type){case r.ActionTypes.APP_INIT:return function(e,t){const{props:r,user:s,viewer:n}=t.payload;o.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested");const{browseExperiments:i}=r,a=l.__rest(r,["browseExperiments"]);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{user:s,viewer:n,experiments:i}),a),{isRightRailCollapsed:(c=s.id,X(c)),rightSidebar:$(s.id)});var c}(s,n);case r.ActionTypes.PUSH_BOLT_IGNORE:return function(e,t){let{added:r,moved:s,removed:n}=e.boltIgnore;return t.payload.added&&(r=new Set(r),t.payload.added.forEach((e=>r.add(e)))),t.payload.moved&&(s=new Set(s),t.payload.moved.forEach((e=>s.add(e)))),t.payload.removed&&(n=new Set(n),t.payload.removed.forEach((e=>n.add(e)))),Object.assign(Object.assign({},e),{boltIgnore:{added:r,moved:s,removed:n}})}(s,n);case r.ActionTypes.POP_BOLT_IGNORE:return function(e,t){let{added:r,moved:s,removed:n}=e.boltIgnore;return t.payload.added&&(r=new Set(r),t.payload.added.forEach((e=>r.delete(e)))),t.payload.moved&&(s=new Set(s),t.payload.moved.forEach((e=>s.delete(e)))),t.payload.removed&&(n=new Set(n),t.payload.removed.forEach((e=>n.delete(e)))),Object.assign(Object.assign({},e),{boltIgnore:{added:r,moved:s,removed:n}})}(s,n);case r.ActionTypes.SELECT_FILES_BY_FQ_PATH:return function(e,t){const{fqPathsToSelect:s}=t.payload,n=s.map((e=>e.toLowerCase())),i=e.unsortedFiles.toList().filter((e=>n.includes(e.fq_path.toLowerCase()))).map((e=>e.fq_path)),a=r.immutableExports.OrderedSet(i),o=i.size?i.get(0):null;return Object.assign(Object.assign({},e),{selection:e.selection.set("selected",a).set("anchor",o)})}(s,n);case r.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return function(e,t){const{canDisplayFolderSizes:r}=t.payload;return Object.assign(Object.assign({},e),{canDisplayFolderSizes:r})}(s,n);case r.ActionTypes.SET_CLIPBOARD_FILES:return function(e,t){const{clipboard:r}=t.payload;return Object.assign(Object.assign({},e),{clipboard:r})}(s,n);case r.ActionTypes.SET_CONTEXT:return function(e,t){const{context:r}=t.payload;return Object.assign(Object.assign({},e),{context:r})}(s,n);case r.ActionTypes.SET_CURRENT_FOLDER_INFO:return function(e,t){const{currentFolderInfo:r}=t.payload;return Object.assign(Object.assign({},e),{currentFolderInfo:r})}(s,n);case r.ActionTypes.SET_FILE_JUMP_FILTER:return function(e,t){const{fileJumpFilter:r}=t.payload;return Object.assign(Object.assign({},e),{fileJumpFilter:r})}(s,n);case r.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return function(e,t){const{filePathsToSelectOnNextUpdate:r}=t.payload;return Object.assign(Object.assign({},e),{filePathsToSelectOnNextUpdate:r})}(s,n);case r.ActionTypes.SET_FOLDER_SIZES:return function(e,t){const{folderSizes:r}=t.payload;return Object.assign(Object.assign({},e),{folderSizes:r})}(s,n);case r.ActionTypes.SET_LOADING_STATE:return function(e,t){const{loadingState:s,path:n}=t.payload;return r.paths_are_equal(n,e.path)?s===r.LoadingState.LOADED?Object.assign(Object.assign({},e),{loadingState:s,filePathsToSelectOnNextUpdate:r.immutableExports.Set()}):Object.assign(Object.assign({},e),{loadingState:s}):e}(s,n);case r.ActionTypes.SET_MOUNT_POINTS:return function(e,t){const{mountPoints:s}=t.payload;return Object.assign(Object.assign({},e),{mountPoints:r.immutableExports.Map(s)})}(s,n);case r.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return function(e,t){const{newFolderCreationState:r}=t.payload;return Object.assign(Object.assign({},e),{newFolderCreationState:r})}(s,n);case r.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return function(e,t){const{paginatedTotalNumFiles:r}=t.payload;return Object.assign(Object.assign({},e),{paginatedTotalNumFiles:r})}(s,n);case r.ActionTypes.SET_PATH:return function(e,t){const{path:r}=t.payload;return Object.assign(Object.assign({},e),{path:r})}(s,n);case r.ActionTypes.SET_SELECTION:return function(e,t){const{selection:r}=t.payload;return Object.assign(Object.assign({},e),{selection:r})}(s,n);case r.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return function(e,t){const{shouldShowDeletedFiles:r}=t.payload;return Object.assign(Object.assign({},e),{shouldShowDeletedFiles:r})}(s,n);case r.ActionTypes.SET_UNSORTED_FILES:return function(e,t){const{unsortedFiles:r}=t.payload;return Object.assign(Object.assign({},e),{unsortedFiles:r})}(s,n);case r.ActionTypes.SHOW_TIMELINE:return function(e,t){return Object.assign(Object.assign({},e),{isRewindVisible:!0,clickRewindTimestamp:t.payload.timestamp})}(s,n);case r.ActionTypes.HIDE_TIMELINE:return function(e,t){return Object.assign(Object.assign({},e),{isRewindVisible:!1})}(s);case r.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return function(e,t){return Object.assign(Object.assign({},e),{isFileViewerShown:t.payload.isShown})}(s,n);case r.ActionTypes.SET_IS_REWIND_ENABLED:return function(e,t){return Object.assign(Object.assign({},e),{isRewindButtonEnabled:t.payload.value})}(s,n);case r.ActionTypes.REQUEST_FOLDER_SIZES:return function(e,r){const{fqPath:s}=r.payload;if(e.isQueryingFolderSizes)return e;const n=e.folderSizes.withMutations((e=>{e.set(s,{size:0,state:t.FetchFolderSizeState.LOADING})}));return Object.assign(Object.assign({},e),{folderSizes:n,isQueryingFolderSizes:!0})}(s,n);case r.ActionTypes.SET_FOLDER_SIZES_PENDING:return function(e,r){const{fetchFolderSizesResp:s}=r.payload;let n=e.currentFolderSizesQuery;const i=e.folderSizes.withMutations((e=>{for(const r of s.sizes_dict)e.update(r.fq_path,{size:0,state:t.FetchFolderSizeState.LOADING},(()=>({size:r.size,state:t.FetchFolderSizeState.LOADING}))),n=n.withMutations((e=>e.add(r.fq_path)))}));return Object.assign(Object.assign({},e),{currentFolderSizesQuery:n,folderSizes:i})}(s,n);case r.ActionTypes.COMPLETE_FOLDER_SIZES:return function(e,t){const{fetchFolderSizeState:s}=t.payload,n=e.folderSizes.withMutations((t=>{e.currentFolderSizesQuery.forEach((r=>{const n=e.folderSizes.get(r);n&&t.update(r,(()=>({size:n.size,state:s})))}))}));return Object.assign(Object.assign({},e),{currentFolderSizesQuery:r.immutableExports.Set(),folderSizes:n,isQueryingFolderSizes:!1})}(s,n);case r.ActionTypes.SET_VIEW_SCOPE:return function(e,t){return Object.assign(Object.assign({},e),{viewScope:t.payload.viewScope})}(s,n);case r.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR:return function(e,t){return Object.assign(Object.assign({},e),{shouldHideFilesAndSidebar:t.payload.shouldHideFilesAndSidebar})}(s,n);case r.ActionTypes.SET_IS_CREATING_SHARED_LINK:return function(e,t){return Object.assign(Object.assign({},e),{isCreatingSharedLinkMap:e.isCreatingSharedLinkMap.set(t.payload.fileIdOrPath,t.payload.isCreatingSharedLink)})}(s,n);case r.ActionTypes.SET_RIGHTRAIL_IS_COLLAPSED:return function(e,t){return Object.assign(Object.assign({},e),{isRightRailCollapsed:t.payload.collapsed})}(s,n);case r.ActionTypes.SET_EXPANDED_BLADE:return function(e,t){return Object.assign(Object.assign({},e),{expandedBlade:t.payload.expandedBlade})}(s,n);case r.ActionTypes.SET_OVERFLOW_MENU_OPEN_REQUEST:return function(e,t){return Object.assign(Object.assign({},e),{overflowMenuOpenRequest:t.payload.overflowMenuOpenRequest})}(s,n);case r.ActionTypes.SET_OVERFLOW_MENU_CLOSE_REQUEST:return function(e,t){return e.overflowMenuCloseRequest===t.payload.overflowMenuCloseRequest?e:Object.assign(Object.assign({},e),{overflowMenuCloseRequest:t.payload.overflowMenuCloseRequest})}(s,n);case r.ActionTypes.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST:return function(e,t){return Object.assign(Object.assign({},e),{inlineOverflowMenuOpenRequest:t.payload.inlineOverflowMenuOpenRequest})}(s,n);case r.ActionTypes.SET_OVERFLOW_MENU_COORDINATES:return function(e,t){return Object.assign(Object.assign({},e),{overflowMenuCoordinates:t.payload.overflowMenuCoordinates})}(s,n);case r.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return function(e,t){const{browsePostTTIExperiments:r}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIExperiments:r})}(s,n);case r.ActionTypes.SET_BROWSE_POST_TTI_DATA:return function(e,t){const{browsePostTTIData:r}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIData:Object.assign(Object.assign({},e.browsePostTTIData),r)})}(s,n);case r.ActionTypes.SET_CREATE_MENU_OPEN_REQUEST:return function(e,t){return Object.assign(Object.assign({},e),{createMenuOpenRequest:t.payload.createMenuOpenRequest})}(s,n);case r.ActionTypes.HANDLE_APP_CLEANUP:return r.defaultBrowseState;case r.ActionTypes.ADD_FROM_GDRIVE:return function(t,r){return new Promise((function(t,r){e(["./c_file_imports_ui_entry"],t,r)})).then((e=>{var s;e.clickOnImportFromGoogleDrive({currentPath:null!==(s=r.payload.path)&&void 0!==s?s:t.path})})),t}(s,n);case r.ActionTypes.SET_FILTER_TYPES:return function(e,t){return Object.assign(Object.assign({},e),{filterTypes:t.payload.filterTypes})}(s,n);case r.ActionTypes.SET_BROWSE_USER:return function(e,t){return null==e.user?Object.assign(Object.assign({},e),{user:t.payload.user}):e}(s,n);case r.ActionTypes.SET_RIGHT_SIDEBAR:return function(e,t){return Object.assign(Object.assign({},e),{rightSidebar:t.payload.sidebar})}(s,n);case r.ActionTypes.SET_BROWSE_VIEWER:return function(e,t){return null==e.viewer?Object.assign(Object.assign({},e),{viewer:t.payload.viewer}):e}(s,n);case r.ActionTypes.SET_CURRENT_FOLDER_RENAME:return function(e,t){const{renameState:r}=t.payload;return r?Object.assign(Object.assign({},e),{currentFolderRenameState:r}):Object.assign(Object.assign({},e),{currentFolderRenameState:null})}(s,n);case r.ActionTypes.SET_CAPTURE_ACCESS:return function(e,t){return Object.assign(Object.assign({},e),{canAccessCapture:t.payload.canAccessCapture})}(s,n);case r.ActionTypes.SET_QUICK_VIEW_FILE:return function(e,t){return Object.assign(Object.assign({},e),{quickViewFileId:t.payload.fileId})}(s,n)}return s}let te;t.FetchFolderSizeState=void 0,(J=t.FetchFolderSizeState||(t.FetchFolderSizeState={})).LOADING="LOADING",J.COMPLETE="COMPLETE",J.NO_ACCESS="NO_ACCESS",J.ERROR="ERROR";var re,se;t.ActionTypes=void 0,(re=t.ActionTypes||(t.ActionTypes={})).FILE_RENAME="STRUCTURED_TAGS/FILE_RENAME",re.SET_TEMPLATES="STRUCTURED_TAGS/SET_TEMPLATES",re.SET_FILE_TO_STRUCTURED_TAGS_MAP="STRUCTURED_TAGS/SET_FILE_TO_STRUCTURED_TAGS_MAP",re.SET_STATUS="STRUCTURED_TAGS/SET_STATUS",t.StructuredTagsNamespaceStatus=void 0,(se=t.StructuredTagsNamespaceStatus||(t.StructuredTagsNamespaceStatus={})).DEFAULT="default",se.IS_LOADING="is_loading",se.DONE="done";const ne={templates:[],fileToTags:{},status:t.StructuredTagsNamespaceStatus.DEFAULT,currentClassification:void 0,tagOptions:[]};function ie(e=ne,s){switch(s.type){case t.ActionTypes.SET_TEMPLATES:return((e,{structuredTagTemplates:r})=>Object.assign(Object.assign({},e),{status:t.StructuredTagsNamespaceStatus.DONE,templates:r}))(e,s.payload);case t.ActionTypes.FILE_RENAME:return((e,{file:t,newFile:s})=>{const n=r.getFileMapKey(t),i=r.getFileMapKey(s),a=e.fileToTags[n];if(!a)return e;const o=e.fileToTags,c=n;o[c];const u=l.__rest(o,["symbol"==typeof c?c:c+""]);return u[i]=a,Object.assign(Object.assign({},e),{fileToTags:u})})(e,s.payload);case t.ActionTypes.SET_STATUS:return((e,{status:t})=>Object.assign(Object.assign({},e),{status:t}))(e,s.payload);case t.ActionTypes.SET_FILE_TO_STRUCTURED_TAGS_MAP:return((e,{fileToTags:t})=>Object.assign(Object.assign({},e),{fileToTags:Object.assign(Object.assign({},e.fileToTags),t)}))(e,s.payload);default:return e}}let ae;const oe=()=>(ae||(ae=r.getStoreAndRegisterReducers({[r.STRUCTURED_TAGS_NAMESPACE_KEY]:ie})),ae);let ce;t.browseLoadingState=b,t.browsePostTTIExperiments=j,t.context=O,t.defaultStructuredTagState=ne,t.experiments=g,t.filePathsToSelectOnNextUpdate=e=>p(e).filePathsToSelectOnNextUpdate,t.getBrowseState=p,t.getCurrentFolderInfo=U,t.getStoreForBrowse=()=>(ce||(ce=r.getStoreAndRegisterReducers({[r.BROWSE_NAMESPACE_KEY]:ee})),r.getStoreForTagging(),te||(te=r.getStoreAndRegisterReducers({[r.CAPTURE_NAMESPACE_KEY]:r.captureReducer})),r.getStoreForBackup(),oe(),ce),t.getStoreForStructuredTags=oe,t.hasUserAddedSampleFile=e=>{const t=p(e).unsortedFiles;for(const e of t.valueSeq().toArray())if(r.File.isSampleFile(e))return!0;return!1},t.isFetchTagsOnBrowseEnabled=function(e){return!!e&&["V1_WITH_BULK_FOR_OPTED_IN_TEAMS","V1_WITH_COLUMN","V2_FOR_OPTED_IN_TEAMS","FETCH_TAGS_DRY_RUN"].includes(e)},t.isInsideBackupFolder=z,t.isInsideFlowsEligibleFolder=x,t.manualTaggingVariant=V,t.mountPoints=e=>p(e).mountPoints,t.path=I,t.postTTIExperiments=F,t.rawUser=e=>p(e).user,t.selectFileByFullPath=(e,t)=>M(e).find((e=>e.fq_path===t.path)),t.selectFilesByFullPaths=(e,t)=>M(e).filter((e=>t.paths.has(e.fq_path)&&(!t.excludeNoAccessSharedFolders||!r.File.isNoAccessSharedFolder(e)))).toArray(),t.selectFilesForSelection=(e,t)=>P(w(e),t.selection),t.selectedFiles=L,t.selectedFilter=v,t.selection=R,t.setIsCollapsed=function(e,t){try{r.UserLocalStorage.set(e,K,t)}catch(e){s.reportException({err:e,severity:"non-critical"})}},t.shouldShowDeletedFiles=e=>p(e).shouldShowDeletedFiles,t.sortedFiles=N,t.structuredTaggingVariant=W,t.unsortedFiles=w,t.urlPrefix=C,t.user=h}));
//# sourceMappingURL=c_capture_redux_store.js-vflYiuxhS.map
