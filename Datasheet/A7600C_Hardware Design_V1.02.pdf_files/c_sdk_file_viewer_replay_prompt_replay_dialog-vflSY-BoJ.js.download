define(["exports","./c_tslib","react","./e_file_viewer_edison_shmodel_file_async","./c_core_i18n","./c_campaigns_campaign_events_api","./e_edison","./c_apex-metrics_src_types","./e_core_exception","./c_core_exception_info","./c_lodash-es_lodash","./c_core_notify","react-dom","metaserver/static/js/modules/constants/env","./c_src_sink_index","metaserver/static/js/modules/constants/viewer","./c_core_xhr","./c_csrf","./c_init_data_runtime","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/fingerprintjs_constants","metaserver/static/js/modules/constants/sharing","./c_security_util","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/pdf_editing","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/unity","metaserver/static/js/modules/constants/files_spa","metaserver/static/js/langpack"],(function(e,t,a,s,i,n,r,o,l,c,d,m,p,u,g,_,f,v,x,y,b,E,w,M,j,h,k,C,D,N,R,F,O,A,B,I){"use strict";function T(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var s=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var P=T(a);s.injectInternalStyle("/static/metaserver/static/js/file_viewer/sdk_file_viewer/upsell/upsell_dialog.module.out-vflxVBabA.css",(e=>"._upsell-dialog-container_1b3vy_6{bottom:0;padding:var(--spacing__unit--3);position:absolute;right:0}._upsell-dialog_1b3vy_6{background:var(--color__faint__background);border:1px solid var(--color__standard__border);border-radius:20px;box-sizing:border-box;max-width:360px;padding:var(--spacing__unit--4);width:100%}._upsell-secondary-button_1b3vy_22{margin-left:var(--spacing__unit--2)}._upsell-footer_1b3vy_26{align-items:center;display:flex;flex-direction:row;justify-content:start;margin-top:var(--spacing__unit--3)}"));const S=({acceptText:e,declineText:t,titleText:i,bodyContent:n,afterAccept:r,afterDecline:o,uxaPrefix:l,redirectUrl:c,acceptLinkProps:d={},"data-testid":m})=>{const[p,u]=a.useState(!1),g=a.useRef(!0);P.useEffect((()=>(g.current=!0,()=>{g.current=!1})));return p?null:P.createElement("div",{className:"_upsell-dialog-container_1b3vy_6","data-testid":m},P.createElement("div",{className:"_upsell-dialog_1b3vy_6"},P.createElement(s.Title,{size:"standard",isBold:!0},i),n,P.createElement("div",{className:"_upsell-footer_1b3vy_26"},P.createElement(s.Button,Object.assign({inverse:!0,variant:"filled",href:c,onClick:()=>r(u),"data-uxa-log":`${l}-upsell-dialog-continue`},d),e),P.createElement("div",{className:"_upsell-secondary-button_1b3vy_22"},P.createElement(s.Button,{variant:"transparent",onClick:()=>{u(!0),o&&o()},"data-uxa-log":`${l}-upsell-dialog-dismiss`},t)))))};S.displayName="UpsellDialog";const U=e=>new s.DefaultUserApiV2Client(e);function G(e,a,i){return t.__awaiter(this,void 0,void 0,(function*(){e&&(yield U(e).ns("reel").rpc("log_replay_preview_entry_point_action",{entrypoint_action:{".tag":a}},{})),s.UserActivityLogger.log("web","replay-fvsdk-dialog-"+a,{variant:i})}))}const z=({user:e,file:a})=>{const[r,o]=P.useState(!1),[l,c]=P.useState(void 0),d=window.location.href;P.useEffect((()=>{t.__awaiter(void 0,void 0,void 0,(function*(){var i,r;if(e&&a&&s.isBrowseFile(a)){const l=null===(i=s.ExtensionCategories[s.getExtension(a)])||void 0===i?void 0:i.toLowerCase();if("video"!==l&&"audio"!==l&&"image"!==l)return;const d=yield function(e,a){return t.__awaiter(this,void 0,void 0,(function*(){return yield U(e).ns("reel").rpc("get_replay_preview_entry_point_eligibility",{media_type:{".tag":a}},{})}))}(e,l);o(!!d.show_entrypoint&&d.show_entrypoint),(null===(r=d.campaign_context)||void 0===r?void 0:r.campaign_impression_id)&&c(n.createMegaphoneCampaignImpressionContext(d.campaign_context.campaign_impression_id,d.campaign_context.campaign_id?`${d.campaign_context.campaign_id}`:void 0,d.campaign_context.campaign_variant_id?`${d.campaign_context.campaign_variant_id}`:void 0))}}))}),[]),P.useEffect((()=>{e&&r&&(G(e,"impression",0),l&&n.logCampaignImpression(l))}),[r]),P.useEffect((()=>{(d.includes("/s/")||d.includes("/sh/")||d.includes("/scl/")||d.includes("/spri/"))&&o(!1)}),[d]);const m=a?`https://replay.dropbox.com/project/creating/${a.file_id}?creationSource=dropbox_previews_prompt`:"https://replay.dropbox.com/?login=true";return r?P.createElement(S,{afterAccept:()=>{e&&G(e,"acknowledgement",0),l&&n.logCampaignClick(l)},afterDecline:()=>{e&&G(e,"dismissal",0),l&&n.logCampaignDismissed(l)},uxaPrefix:"replay-fvsdk-prompt",titleText:r?a&&s.isBrowseFile(a)&&"IMAGE"===s.ExtensionCategories[s.getExtension(a)]?i.intl.formatMessage({id:"fJp3JL",defaultMessage:"Fast-track image approvals with Dropbox Replay"}):a&&s.isBrowseFile(a)&&"AUDIO"===s.ExtensionCategories[s.getExtension(a)]?i.intl.formatMessage({id:"ValGuy",defaultMessage:"Fast-track audio approvals with Dropbox Replay"}):i.intl.formatMessage({id:"qQoYME",defaultMessage:"Fast-track video approvals with Dropbox Replay"}):a&&s.isBrowseFile(a)&&"IMAGE"===s.ExtensionCategories[s.getExtension(a)]?i.intl.formatMessage({id:"fJp3JL",defaultMessage:"Fast-track image approvals with Dropbox Replay"}):a&&s.isBrowseFile(a)&&"AUDIO"===s.ExtensionCategories[s.getExtension(a)]?i.intl.formatMessage({id:"ValGuy",defaultMessage:"Fast-track audio approvals with Dropbox Replay"}):i.intl.formatMessage({id:"Svd0z9",defaultMessage:"Fast-track feedback with Dropbox Replay."}),bodyContent:r?P.createElement(P.Fragment,null,P.createElement(s.Text,{className:"replay-dialog-subtext",tagName:"p",isBold:!0},i.intl.formatMessage({id:"0RFIO+",defaultMessage:"Speed up the review and approval process for video, image, and audio files."})),P.createElement(s.Text,{className:"replay-dialog-subtext",tagName:"div"},P.createElement("ul",{className:"replay-dialog-list",style:{paddingInlineStart:"20px"}},P.createElement("li",null,i.intl.formatMessage({id:"qOrqAu",defaultMessage:"Provide frame-accurate comments and markups"})),P.createElement("li",null,i.intl.formatMessage({id:"501bEW",defaultMessage:"Connect the feedback you receive with your video editing tools including Adobe Premiere Pro, Blackmagic Design DaVinci Resolve, and more."})),P.createElement("li",null,i.intl.formatMessage({id:"xQjeY3",defaultMessage:"Review videos in a real-time virtual viewing room"}))))):P.createElement(P.Fragment,null,P.createElement(s.Text,{className:"replay-dialog-subtext",tagName:"p",isBold:!0},i.intl.formatMessage({id:"Wj4Gtx",defaultMessage:"Optimize your approval process and:"})),P.createElement(s.Text,{className:"replay-dialog-subtext",tagName:"div"},P.createElement("ul",{className:"replay-dialog-list",style:{paddingInlineStart:"20px"}},P.createElement("li",null,i.intl.formatMessage({id:"UnCNrR",defaultMessage:"Collect comments in one place."})),P.createElement("li",null,i.intl.formatMessage({id:"CE/I0u",defaultMessage:"Mark up individual video frames."})),P.createElement("li",null,i.intl.formatMessage({id:"tid1YH",defaultMessage:"Host a live review of your video."})),P.createElement("li",null,i.intl.formatMessage({id:"prvJus",defaultMessage:"Connect third-party creative tools like Adobe Premiere Pro, Da Vinci Resolve, and more."}))))),acceptText:i.intl.formatMessage({id:"RGcvfk",defaultMessage:"Get started"}),declineText:i.intl.formatMessage({id:"t97mKK",defaultMessage:"Not now"}),redirectUrl:m}):null};z.displayName="ReplayDialog",e.ReplayDialog=z}));
//# sourceMappingURL=c_sdk_file_viewer_replay_prompt_replay_dialog.js-vflF5n6c3.map
